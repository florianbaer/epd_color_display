# Production docker-compose for EPD Color Display
# Single container with backend serving frontend

services:
  app:
    build: .
    container_name: epd-app
    ports:
      - "80:8000"
    volumes:
      - ./prompt.md:/app/prompt.md
      - ./prompt_history.csv:/app/prompt_history.csv
      - ./generated_images:/app/generated_images
      - ./.env:/app/.env
      - /sys:/sys
    devices:
      - "/dev/gpiochip0:/dev/gpiochip0"
      - "/dev/spidev0.0:/dev/spidev0.0"
    environment:
      - TZ=${TZ:-Europe/Zurich}
      - SCHEDULE_TIME=${SCHEDULE_TIME:-19:00}
      - AUTO_GENERATE=${AUTO_GENERATE:-true}
    restart: unless-stopped
    privileged: true
